<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Slopsquatting Scanner - AI Security Tools</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); min-height: 100vh; color: #e4e4e7; }
    .container { max-width: 1000px; margin: 0 auto; padding: 2rem; }
    .back-link { display: inline-flex; align-items: center; gap: 0.5rem; color: #a1a1aa; text-decoration: none; margin-bottom: 1.5rem; font-size: 0.9rem; }
    .back-link:hover { color: #06b6d4; }
    header { text-align: center; margin-bottom: 2rem; }
    h1 { font-size: 2.5rem; background: linear-gradient(90deg, #f59e0b, #d97706); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 0.5rem; }
    .subtitle { color: #a1a1aa; font-size: 1.1rem; }
    .warning-banner { background: rgba(234, 179, 8, 0.1); border: 1px solid rgba(234, 179, 8, 0.3); border-radius: 8px; padding: 1rem; margin-bottom: 2rem; display: flex; align-items: flex-start; gap: 0.75rem; }
    .warning-banner svg { flex-shrink: 0; color: #eab308; }
    .warning-banner p { font-size: 0.9rem; line-height: 1.5; }
    .input-section { background: rgba(255, 255, 255, 0.05); border-radius: 12px; padding: 1.5rem; margin-bottom: 1.5rem; }
    .form-group { margin-bottom: 1rem; }
    label { display: block; margin-bottom: 0.5rem; color: #a1a1aa; font-size: 0.9rem; }
    select, textarea { width: 100%; padding: 0.75rem; background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 8px; color: #e4e4e7; font-size: 1rem; }
    textarea { height: 300px; font-family: 'Monaco', 'Menlo', monospace; font-size: 0.9rem; resize: vertical; }
    textarea:focus, select:focus { outline: none; border-color: #f59e0b; }
    button { width: 100%; padding: 1rem; background: linear-gradient(90deg, #f59e0b, #d97706); border: none; border-radius: 8px; color: white; font-size: 1.1rem; font-weight: 600; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; }
    button:hover { transform: translateY(-2px); box-shadow: 0 4px 20px rgba(245, 158, 11, 0.3); }
    button:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
    .results-section { background: rgba(255, 255, 255, 0.05); border-radius: 12px; padding: 1.5rem; display: none; }
    .results-section.visible { display: block; }
    .summary { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-bottom: 1.5rem; }
    .summary-card { background: rgba(0, 0, 0, 0.3); border-radius: 8px; padding: 1rem; text-align: center; }
    .summary-card .value { font-size: 2rem; font-weight: 700; }
    .summary-card .label { color: #a1a1aa; font-size: 0.8rem; text-transform: uppercase; }
    .risk-none .value, .risk-low .value { color: #22c55e; }
    .risk-medium .value { color: #eab308; }
    .risk-high .value { color: #ef4444; }
    .packages-list { display: flex; flex-direction: column; gap: 0.75rem; }
    .package-item { background: rgba(0, 0, 0, 0.3); border-radius: 8px; padding: 1rem; display: flex; align-items: center; gap: 1rem; }
    .package-status { width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
    .package-status.exists { background: rgba(34, 197, 94, 0.2); color: #22c55e; }
    .package-status.not-found { background: rgba(239, 68, 68, 0.2); color: #ef4444; }
    .package-info { flex: 1; }
    .package-name { font-weight: 600; font-family: monospace; font-size: 1.1rem; }
    .package-desc { color: #a1a1aa; font-size: 0.85rem; margin-top: 0.25rem; }
    .package-badge { padding: 0.25rem 0.75rem; border-radius: 999px; font-size: 0.75rem; font-weight: 600; text-transform: uppercase; }
    .package-badge.exists { background: rgba(34, 197, 94, 0.2); color: #22c55e; }
    .package-badge.not-found { background: rgba(239, 68, 68, 0.2); color: #ef4444; }
    footer { text-align: center; margin-top: 2rem; color: #71717a; font-size: 0.85rem; }
    footer a { color: #06b6d4; text-decoration: none; }
    @media (max-width: 768px) { .summary { grid-template-columns: repeat(2, 1fr); } h1 { font-size: 1.8rem; } }
  </style>
</head>
<body>
  <div class="container">
    <a href="/" class="back-link">‚Üê Back to all tools</a>
    <header>
      <h1>Slopsquatting Scanner</h1>
      <p class="subtitle">Detect hallucinated package names in AI-generated code</p>
    </header>
    <div class="warning-banner">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/>
      </svg>
      <p><strong>What is Slopsquatting?</strong> AI code assistants sometimes "hallucinate" non-existent package names. Attackers can register these fake names with malicious code. When developers blindly install AI-suggested packages, they may unknowingly execute malware.</p>
    </div>
    <div class="input-section">
      <div class="form-group">
        <label for="language">Programming Language</label>
        <select id="language">
          <option value="javascript">JavaScript / TypeScript (npm)</option>
          <option value="python">Python (PyPI)</option>
        </select>
      </div>
      <div class="form-group">
        <label for="code">Paste AI-generated code</label>
        <textarea id="code" placeholder="// Paste your AI-generated code here..."></textarea>
      </div>
      <button id="scanBtn" onclick="scanCode()">Scan for Hallucinated Packages</button>
    </div>
    <div id="results" class="results-section">
      <h2 style="margin-bottom: 1rem;">Scan Results</h2>
      <div class="summary">
        <div class="summary-card"><div class="value" id="totalCount">0</div><div class="label">Packages Found</div></div>
        <div class="summary-card"><div class="value" id="existingCount" style="color: #22c55e;">0</div><div class="label">Verified</div></div>
        <div class="summary-card"><div class="value" id="notFoundCount" style="color: #ef4444;">0</div><div class="label">Not Found</div></div>
        <div class="summary-card" id="riskCard"><div class="value" id="riskLevel">LOW</div><div class="label">Risk Level</div></div>
      </div>
      <div id="packagesList" class="packages-list"></div>
    </div>
    <footer><p>Part of <a href="/">AI Security Tools</a> by <a href="https://beforethecommit.com" target="_blank">Before The Commit</a></p></footer>
  </div>
  <script>
    async function scanCode() {
      const code = document.getElementById('code').value;
      const language = document.getElementById('language').value;
      const btn = document.getElementById('scanBtn');
      const results = document.getElementById('results');
      if (!code.trim()) { alert('Please paste some code to scan'); return; }
      btn.disabled = true; btn.textContent = 'Scanning...';
      try {
        const response = await fetch('/api/scan', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ code, language }) });
        const data = await response.json();
        if (data.error) { alert('Error: ' + data.error); return; }
        document.getElementById('totalCount').textContent = data.summary.total;
        document.getElementById('existingCount').textContent = data.summary.existing;
        document.getElementById('notFoundCount').textContent = data.summary.notFound;
        const riskCard = document.getElementById('riskCard');
        const riskLevel = document.getElementById('riskLevel');
        riskCard.className = 'summary-card risk-' + data.summary.riskLevel;
        riskLevel.textContent = data.summary.riskLevel.toUpperCase();
        const list = document.getElementById('packagesList');
        list.innerHTML = '';
        if (data.packages.length === 0) {
          list.innerHTML = '<p style="color: #a1a1aa; text-align: center; padding: 2rem;">No external packages detected.</p>';
        } else {
          data.packages.forEach(pkg => {
            const item = document.createElement('div');
            item.className = 'package-item';
            const statusClass = pkg.exists ? 'exists' : 'not-found';
            const statusIcon = pkg.exists ? '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>' : '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>';
            const description = pkg.exists ? (pkg.description || 'Package exists on registry') : 'Package NOT found - potential hallucination!';
            item.innerHTML = '<div class="package-status ' + statusClass + '">' + statusIcon + '</div><div class="package-info"><div class="package-name">' + pkg.name + '</div><div class="package-desc">' + description + '</div></div><span class="package-badge ' + statusClass + '">' + (pkg.exists ? 'Verified' : 'Not Found') + '</span>';
            list.appendChild(item);
          });
        }
        results.classList.add('visible');
        results.scrollIntoView({ behavior: 'smooth' });
      } catch (error) { alert('Error: ' + error.message); } finally { btn.disabled = false; btn.textContent = 'Scan for Hallucinated Packages'; }
    }
  </script>
</body>
</html>
