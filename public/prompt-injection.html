<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Prompt Injection Detector - AI Security Tools</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); min-height: 100vh; color: #e4e4e7; }
    .container { max-width: 1000px; margin: 0 auto; padding: 2rem; }
    .back-link { display: inline-flex; align-items: center; gap: 0.5rem; color: #a1a1aa; text-decoration: none; margin-bottom: 1.5rem; font-size: 0.9rem; }
    .back-link:hover { color: #06b6d4; }
    header { text-align: center; margin-bottom: 2rem; }
    h1 { font-size: 2.5rem; background: linear-gradient(90deg, #8b5cf6, #7c3aed); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 0.5rem; }
    .subtitle { color: #a1a1aa; font-size: 1.1rem; }
    .warning-banner { background: rgba(139, 92, 246, 0.1); border: 1px solid rgba(139, 92, 246, 0.3); border-radius: 8px; padding: 1rem; margin-bottom: 2rem; display: flex; align-items: flex-start; gap: 0.75rem; }
    .warning-banner svg { flex-shrink: 0; color: #8b5cf6; }
    .warning-banner p { font-size: 0.9rem; line-height: 1.5; }
    .input-section { background: rgba(255, 255, 255, 0.05); border-radius: 12px; padding: 1.5rem; margin-bottom: 1.5rem; }
    .form-group { margin-bottom: 1rem; }
    label { display: block; margin-bottom: 0.5rem; color: #a1a1aa; font-size: 0.9rem; }
    textarea { width: 100%; height: 300px; padding: 1rem; background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 8px; color: #e4e4e7; font-family: 'Monaco', 'Menlo', monospace; font-size: 0.9rem; resize: vertical; }
    textarea:focus { outline: none; border-color: #8b5cf6; }
    button { width: 100%; padding: 1rem; background: linear-gradient(90deg, #8b5cf6, #7c3aed); border: none; border-radius: 8px; color: white; font-size: 1.1rem; font-weight: 600; cursor: pointer; transition: transform 0.2s; }
    button:hover { transform: translateY(-2px); }
    button:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
    .results-section { background: rgba(255, 255, 255, 0.05); border-radius: 12px; padding: 1.5rem; display: none; }
    .results-section.visible { display: block; }
    .summary { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-bottom: 1.5rem; }
    .summary-card { background: rgba(0, 0, 0, 0.3); border-radius: 8px; padding: 1rem; text-align: center; }
    .summary-card .value { font-size: 2rem; font-weight: 700; }
    .summary-card .label { color: #a1a1aa; font-size: 0.8rem; text-transform: uppercase; }
    .risk-none .value { color: #22c55e; }
    .risk-medium .value { color: #eab308; }
    .risk-high .value, .risk-critical .value { color: #ef4444; }
    .findings-list { display: flex; flex-direction: column; gap: 0.75rem; }
    .finding-item { background: rgba(0, 0, 0, 0.3); border-radius: 8px; padding: 1rem; border-left: 3px solid; }
    .finding-item.critical { border-color: #ef4444; }
    .finding-item.high { border-color: #f59e0b; }
    .finding-item.medium { border-color: #eab308; }
    .finding-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem; }
    .finding-type { font-weight: 600; color: #f4f4f5; }
    .finding-severity { padding: 0.2rem 0.5rem; border-radius: 4px; font-size: 0.7rem; font-weight: 600; text-transform: uppercase; }
    .finding-severity.critical { background: rgba(239, 68, 68, 0.2); color: #ef4444; }
    .finding-severity.high { background: rgba(245, 158, 11, 0.2); color: #f59e0b; }
    .finding-severity.medium { background: rgba(234, 179, 8, 0.2); color: #eab308; }
    .finding-desc { color: #a1a1aa; font-size: 0.9rem; margin-bottom: 0.5rem; }
    .finding-context { background: rgba(0, 0, 0, 0.3); padding: 0.5rem; border-radius: 4px; font-family: monospace; font-size: 0.8rem; color: #71717a; word-break: break-all; }
    .finding-line { color: #8b5cf6; font-size: 0.8rem; margin-top: 0.5rem; }
    footer { text-align: center; margin-top: 2rem; color: #71717a; font-size: 0.85rem; }
    footer a { color: #06b6d4; text-decoration: none; }
    @media (max-width: 768px) { .summary { grid-template-columns: repeat(2, 1fr); } h1 { font-size: 1.8rem; } }
  </style>
</head>
<body>
  <div class="container">
    <a href="/" class="back-link">‚Üê Back to all tools</a>
    <header>
      <h1>Prompt Injection Detector</h1>
      <p class="subtitle">Find code patterns vulnerable to prompt injection attacks</p>
    </header>
    <div class="warning-banner">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="4 17 10 11 4 5"/><line x1="12" y1="19" x2="20" y2="19"/>
      </svg>
      <p><strong>What is Prompt Injection?</strong> The new SQL injection. When user input is concatenated to LLM prompts without proper sanitization, attackers can manipulate the AI's behavior. OpenAI admits it may never be fully solved. Natural language has no syntax to validate.</p>
    </div>
    <div class="input-section">
      <div class="form-group">
        <label for="code">Paste code that interacts with LLMs</label>
        <textarea id="code" placeholder="# Paste your Python or JavaScript code that calls LLM APIs...

# Example vulnerable pattern:
prompt = 'Summarize: ' + user_input
response = openai.complete(prompt)

# Another vulnerable pattern:
os.system(response.text)  # Command injection via LLM output"></textarea>
      </div>
      <button id="scanBtn" onclick="scanCode()">Scan for Injection Vulnerabilities</button>
    </div>
    <div id="results" class="results-section">
      <h2 style="margin-bottom: 1rem;">Scan Results</h2>
      <div class="summary">
        <div class="summary-card"><div class="value" id="totalCount">0</div><div class="label">Issues Found</div></div>
        <div class="summary-card"><div class="value" id="criticalCount" style="color: #ef4444;">0</div><div class="label">Critical</div></div>
        <div class="summary-card"><div class="value" id="highCount" style="color: #f59e0b;">0</div><div class="label">High</div></div>
        <div class="summary-card" id="riskCard"><div class="value" id="riskLevel">NONE</div><div class="label">Risk Level</div></div>
      </div>
      <div id="findingsList" class="findings-list"></div>
    </div>
    <footer><p>Part of <a href="/">AI Security Tools</a> by <a href="https://beforethecommit.com" target="_blank">Before The Commit</a></p></footer>
  </div>
  <script>
    async function scanCode() {
      const code = document.getElementById('code').value;
      const btn = document.getElementById('scanBtn');
      const results = document.getElementById('results');
      if (!code.trim()) { alert('Please paste some code to scan'); return; }
      btn.disabled = true; btn.textContent = 'Scanning...';
      try {
        const response = await fetch('/api/scan/prompt-injection', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ code }) });
        const data = await response.json();
        if (data.error) { alert('Error: ' + data.error); return; }
        document.getElementById('totalCount').textContent = data.summary.total;
        document.getElementById('criticalCount').textContent = data.summary.critical;
        document.getElementById('highCount').textContent = data.summary.high;
        const riskCard = document.getElementById('riskCard');
        const riskLevel = document.getElementById('riskLevel');
        riskCard.className = 'summary-card risk-' + data.summary.riskLevel;
        riskLevel.textContent = data.summary.riskLevel.toUpperCase();
        const list = document.getElementById('findingsList');
        list.innerHTML = '';
        if (data.findings.length === 0) {
          list.innerHTML = '<p style="color: #22c55e; text-align: center; padding: 2rem;">No prompt injection vulnerabilities detected.</p>';
        } else {
          data.findings.forEach(f => {
            const item = document.createElement('div');
            item.className = 'finding-item ' + f.severity;
            item.innerHTML = '<div class="finding-header"><span class="finding-type">' + f.type.replace(/-/g, ' ').replace(/\b\w/g, c => c.toUpperCase()) + '</span><span class="finding-severity ' + f.severity + '">' + f.severity + '</span></div><div class="finding-desc">' + f.description + '</div><div class="finding-context">' + f.context.substring(0, 150) + (f.context.length > 150 ? '...' : '') + '</div><div class="finding-line">Line ' + f.line + '</div>';
            list.appendChild(item);
          });
        }
        results.classList.add('visible');
        results.scrollIntoView({ behavior: 'smooth' });
      } catch (error) { alert('Error: ' + error.message); } finally { btn.disabled = false; btn.textContent = 'Scan for Injection Vulnerabilities'; }
    }
  </script>
</body>
</html>
